
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="MassiPipe - a data processing pipeline for hyperspectral data acquired in the Massimal project.">
      
      
      
      
        <link rel="prev" href="../quicklook_ref/">
      
      
        <link rel="next" href="../irradiance_ref/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.29">
    
    
      
        <title>Radiance calibration reference - MassiPipe Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.76a95c52.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#massipipe.radiance" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="MassiPipe Documentation" class="md-header__button md-logo" aria-label="MassiPipe Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MassiPipe Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Radiance calibration reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/mh-skjelvareid/massipipe" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="MassiPipe Documentation" class="md-nav__button md-logo" aria-label="MassiPipe Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    MassiPipe Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mh-skjelvareid/massipipe" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../example_usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example Usage
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../config_ref/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration reference
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pipeline_ref/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pipeline reference
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quicklook_ref/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quicklook reference
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Radiance calibration reference
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Radiance calibration reference
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#massipipe.radiance" class="md-nav__link">
    <span class="md-ellipsis">
      radiance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#massipipe.radiance.RadianceCalibrationDataset" class="md-nav__link">
    <span class="md-ellipsis">
      RadianceCalibrationDataset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#massipipe.radiance.RadianceConverter" class="md-nav__link">
    <span class="md-ellipsis">
      RadianceConverter
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../irradiance_ref/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Irradiance calibration reference
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reflectance_ref/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reflectance calculation reference
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../georeferencing_ref/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IMU data processing and simple georeferencing reference
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../mosaic_ref/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mosaicing reference
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils_ref/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utilities reference
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#massipipe.radiance" class="md-nav__link">
    <span class="md-ellipsis">
      radiance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#massipipe.radiance.RadianceCalibrationDataset" class="md-nav__link">
    <span class="md-ellipsis">
      RadianceCalibrationDataset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#massipipe.radiance.RadianceConverter" class="md-nav__link">
    <span class="md-ellipsis">
      RadianceConverter
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Radiance calibration reference</h1>

<div class="doc doc-object doc-module">



<a id="massipipe.radiance"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="massipipe.radiance.RadianceCalibrationDataset" class="doc doc-heading">
            <code>RadianceCalibrationDataset</code>


</h2>


    <div class="doc doc-contents ">


      <p>A radiance calibration dataset for Resonon hyperspectral cameras.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="massipipe.radiance.RadianceCalibrationDataset.calibration_file">calibration_file</span></code></td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to Imager Calibration Pack (*.icp) file</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="massipipe.radiance.RadianceCalibrationDataset.calibration_dir">calibration_dir</span></code></td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Folder into which all the data in the calibration_file
is put (unzipped).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="massipipe.radiance.RadianceCalibrationDataset.gain_file_path">gain_file_path</span></code></td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to "gain file", i.e. ENVI file with "gain spectra",
per-wavelength values for converting from raw (digital numbers)
data to radiance data (in physical units).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="massipipe.radiance.RadianceCalibrationDataset.dark_frame_paths">dark_frame_paths</span></code></td>
            <td>
                  <code>list[<span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of paths to "dark frames", i.e. files with a single line / spectrum
taken with no light incident on the sensor, taken with different gain
and shutter values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="massipipe.radiance.RadianceCalibrationDataset.get_rad_conv_frame" href="#massipipe.radiance.RadianceCalibrationDataset.get_rad_conv_frame">get_rad_conv_frame</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns radiance conversion frame, shape (n_samples, n_channels)</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="massipipe.radiance.RadianceCalibrationDataset.get_closest_dark_frame" href="#massipipe.radiance.RadianceCalibrationDataset.get_closest_dark_frame">get_closest_dark_frame</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns dark frame which best matches given gain and shutter values</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>




  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="massipipe.radiance.RadianceCalibrationDataset.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">calibration_file</span><span class="p">,</span> <span class="n">calibration_dir_name</span><span class="o">=</span><span class="s1">&#39;radiance_calibration_frames&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>calibration_file</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to *.icp Resonon "Imager Calibration Pack" file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>calibration_dir_name</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of subdirectory into which calibration frames are unzipped</p>
              </div>
            </td>
            <td>
                  <code>&#39;radiance_calibration_frames&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>zipfile.BadZipfile:</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given *.icp file is not a valid zip file</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="massipipe.radiance.RadianceCalibrationDataset.get_closest_dark_frame" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_closest_dark_frame</span><span class="p">(</span><span class="n">gain</span><span class="p">,</span> <span class="n">shutter</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Get dark frame which most closely matches given gain and shutter values</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>gain</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[int, float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Gain value used for search, typically gain value of image that should
be converted from raw to radiance. Values follow Resonon convention
used in header files++ (logarithmic values, 20 log10).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>shutter</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[int, float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Shutter value used for search, typically shutter value of image that should
be converted from raw to radiance. Values follow Resonon convention
used in header files++ (unit: milliseconds).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>frame</code></td>            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Single dark frame, shape (1,n_samples,n_channels)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>wl</code></td>            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vector of wavelengths for each spectral channel (nanometers)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>metadata</code></td>            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metadata from ENVI header, formatted as dictionary</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>closest_gain</code></td>            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Gain value for closest match among available dark frames</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>closest_shutter</code></td>            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Shutter value for closest match among available dark frames</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="massipipe.radiance.RadianceCalibrationDataset.get_rad_conv_frame" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_rad_conv_frame</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Read and return radiance conversion curve ("gain" file)</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>frame</code></td>            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Radiance conversion frame, shape (1,n_samples,n_channels)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>wl</code></td>            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vector of wavelengths for each spectral channel (nanometers)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>metadata</code></td>            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metadata from ENVI header, formatted as dictionary</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="massipipe.radiance.RadianceConverter" class="doc doc-heading">
            <code>RadianceConverter</code>


</h2>


    <div class="doc doc-contents ">


      <p>A class for converting raw hyperspectral images from Pika L cameras to radiance.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="massipipe.radiance.RadianceConverter.radiance_calibration_file">radiance_calibration_file</span></code></td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to Imager Calibration Pack (*.icp) file.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="massipipe.radiance.RadianceConverter.rc_dataset">rc_dataset</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="massipipe.radiance.RadianceCalibrationDataset" href="#massipipe.radiance.RadianceCalibrationDataset">RadianceCalibrationDataset</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A radiance calibration dataset object representing the calibration
data supplied in the *.icp file.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="massipipe.radiance.RadianceConverter.rad_conv_frame">rad_conv_frame</span></code></td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frame representing conversion factors from raw data to radiance for
every pixel and wavelength.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="massipipe.radiance.RadianceConverter.rad_conv_metadata">rad_conv_metadata</span></code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ENVI metadata for rad_conv_frame</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="massipipe.radiance.RadianceConverter.convert_raw_image_to_radiance" href="#massipipe.radiance.RadianceConverter.convert_raw_image_to_radiance">convert_raw_image_to_radiance</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Convert single image (3D array) from raw to radiance</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="massipipe.radiance.RadianceConverter.convert_raw_file_to_radiance" href="#massipipe.radiance.RadianceConverter.convert_raw_file_to_radiance">convert_raw_file_to_radiance</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Read raw file, convert, and save as radiance image</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>Most image sensors register some amount of "dark current", i.e. a signal
which is present even though no photons enter the sensor. The dark current
should be subtracted for the measurement to be as accurate as possible.
The amount of dark current also depends on camera gain (signal amplification)
and camera shutter (time available for the sensor to collect photons).
The *.icp calibration file (ICP = "Imager Calibration Pack") is a ZIP archine
which includes dark current measurements taken at different gain and shutter
settings (raw images). To remove dark current from a new image, this set of
dark current frames is searched, and the one which best matches the gain and
shutter values of the new image is used as a reference. The dark frame
needs to be scaled to account for differences in binning, gain and shutter
between it and the new image. The dark frame is then subtracted from the image.</p>
<p>To convert raw images from digital numbers to radiance, a physical quantity,
the raw images are multiplied with a "radiance conversion frame". This frame
represents "microflicks per digital number" for every pixel and every
spectral channel, where the spectral radiance unit "flick" is defined as
"watts per steradian per square centimeter of surface per micrometer of span
in wavelength" (see https://en.wikipedia.org/wiki/Flick_(physics) ).
The radiance conversion frame also needs to be scaled to account for differences
in binning, gain and shutter.</p>
<p>When both the dark current frame (DCF) and the radiance conversion frame (RCF)
have been scaled to match the raw input image (IM), the radiance output image
(OI) is given by OI = (IM-DCF)*RCF</p>
<p>Note that the conversion assumes that the camera response is completely linear
after dark current is removed. This may not be completely accurate, but is
assumed to be within an acceptable margin of error.</p>
</details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="massipipe.radiance.RadianceConverter.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">radiance_calibration_file</span><span class="p">,</span> <span class="n">set_saturated_pixels_to_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">saturation_value</span><span class="o">=</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">12</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>radiance_calibration_file</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to Imager Calibration Pack (<em>.icp) file.
The </em>.icp file is a zip archive, and the file will be unzipped into
a subfolder in the same folder containing the *.icp file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>set_saturated_pixels_to_zero</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[bool, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, saturated pixels are set to all-zero (across all bands).</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>saturation_value</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum digital number for camera sensor.</p>
              </div>
            </td>
            <td>
                  <code>2 ** 12 - 1</code>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="massipipe.radiance.RadianceConverter.convert_raw_image_to_radiance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_raw_image_to_radiance</span><span class="p">(</span><span class="n">raw_image</span><span class="p">,</span> <span class="n">raw_image_metadata</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Convert raw image (3d array) to radiance image</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>raw_image</code></td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raw hyperspectral image, shape (n_lines, n_samples, n_channels)
The image is assumed to have been created by a Resonon Pika L
camera, which has 900 spatial pixels x 600 spectral channels
before any binning has been applied. Typically, spectral binning
with a bin size of 2 is applied during image aqusition, resulting
in images with shape (n_lines, 900, 300). It is assumed that no
spectral or spatial (sample) cropping has been applied. Where binning
has been applied, it is assumed that
    - n_samples<em>sample_bin_size = 900
    - n_channels</em>channel_bin_size = 600</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>raw_image_metadata</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ENVI metadata formatted as dict.
See spectral.io.envi.open()</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>radiance_image</code></td>            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>(int16, microflicks)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Radiance image with same shape as raw image, with spectral radiance
in units of microflicks = 10e-5 W/(m2*nm). Microflicks are used
to be consistent with Resonon formatting, and because microflick
values typically are in a range suitable for (memory-efficient)
encoding as 16-bit unsigned integer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError:</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>In case the raw image does not have the expected dimensions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="references:" open>
  <summary>References:</summary>
  <ul>
<li><a href="https://en.wikipedia.org/wiki/Flick_(physics)">"flick" unit</a></li>
</ul>
</details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="massipipe.radiance.RadianceConverter.convert_raw_file_to_radiance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_raw_file_to_radiance</span><span class="p">(</span><span class="n">raw_header_path</span><span class="p">,</span> <span class="n">radiance_header_path</span><span class="p">,</span> <span class="n">geotransform_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interleave</span><span class="o">=</span><span class="s1">&#39;bip&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Read raw image file, convert to radiance, and save to file</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>raw_header_path</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to raw hyperspectral image acquired with Resonon Pika L camera.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>radiance_header_path</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to save converted radiance image to.
The name of the header file should match the 'interleave' argument
(default: bip), e.g. 'radiance_image.bip.hdr'</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>geotransform_path</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to JSON file with geotransform information.
If not None, the "envi_map_info" from the grotransform file
is inserted into the header of the radiance file (as "map info").</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>interleave</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String indicating how binary image file is organized.
See spectral.io.envi.save_image()</p>
              </div>
            </td>
            <td>
                  <code>&#39;bip&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>The radiance image is saved with the same metadata as the raw image.</p>
</details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>